<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
<title>Home</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300&display=swap" rel="stylesheet">

<style>
    *
    { 
        font-family: 'Open Sans', sans-serif; 
        font-size: 12pt;
    }

    a:link, a:visited
    {
        text-decoration: none;
        color: black;
        font-weight: bold;
        
    }

    #results:empty
    {
        border: none
    }

    #results 
    {
        border: 1px solid #ccc;
        padding: 1px;
    }
    #results ul 
    {
        list-style-type: none;
        padding: 0;
        margin: 0;
    }
    #results ul li 
    {

    }
    #results ul li:hover 
    {
        background: #eee;
    }    
</style>
<script src=""></script>
<script>
    function suggest(val)
    {
        let results_div = document.getElementById('results');
        results_div.innerHTML = '';
        if (val == '') return;

        fetch('/suggest/' + val).then(function (response) 
        {
            return response.json();
        }).then(function (response) 
        {
            let list = ''
            let results = response.results;
            for (let i = 0, n = results.length; i < n; i++) {
                result = results[i]
                list += '<li><a href="/add_airport/' + result.ident + '">' + result.ident + ' ' + result.name + '</a></li>';
            }
            results_div.innerHTML = '<ul>' + list + '</ul>';
            return true;
        }).catch(function (err) 
        {
            console.warn('duh!', err);
            return false;
        });    
    }


    function toggle_display(href)
    {
        let id = href.substring(href.indexOf('#') + 1)
        let style = document.getElementById(id).style;
        if (style.display == 'none') style.display = 'block'; else style.display = 'none';
    }
</script>

<body>
    
    <form autocomplete="off">
        Search Airport <input type="text" onkeyup="suggest(this.value)"/>
        <div id="results"></div>
    </form>
    
    <ul>
        {%- for airport in airports %}
            {%- if airport.ident in selected_airports %}
            <li>
                <a href="/remove_airport/{{ airport.ident }}" title="Remove">&Cross;</a> <a href="#" title="Move Up">&uarr;</a>
                <a href="#{{ airport.ident }}" onclick="toggle_display(this.href)">{{ airport.ident }} {{ airport.name }}</a>
                <ul id="{{ airport.ident }}">
                    <li><b>MET</b> {{ airport.metar }}</li>
                    <li><b>TAF</b> {{ airport.taf }}</li>
                </ul>
            </li>
            {%- endif %}
        {%- endfor %}
    </ul>
    
</body>
</html>